<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MicroAd for GTM</title>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
</head>

<body>
    <div id="AdUnit">
        <div id="one">123</div>
        <div id="two">456</div>
        <div id="three">789</div>
    </div>

    <!-- Original Code [Native ads]
    <div id="MicroAd-microad-test" class="makAd" style="margin:0">
        <div id="compass-fit-{4279417}{adslot}"></div>
        <script charset="UTF-8">
            (function(){
                var _lgy_lw = document.createElement("script");
    	            _lgy_lw.type = "text/javascript";
    	            _lgy_lw.charset = "UTF-8";
    	            _lgy_lw.async = true;
    	            _lgy_lw.src= (("https:" == document.location.protocol) ? "https://" : "http://")+"nt.compass-fit.jp/lift_widget.js?adspot_id={4279416}{adslot}";
                var _lgy_lw_0 = document.getElementsByTagName("script")[0];
    	            _lgy_lw_0.parentNode.insertBefore(_lgy_lw, _lgy_lw_0);
            })();
            </script>
        </div>        
-->
    <script>
        /// ========== 廣告區塊資訊 (Main Object) ========== ///
        let adsBlock_microad = [{
            note: '[TEST] TEST 廣告',
            divid: 'microad-test',
            divclass: 'makAd',
            adslot: '4279417',
            dom: 'body',
            place: 'prepend',
            stycss: 'margin:0',
            wait: ''
        }, {
            note: '[TEST] TEST 廣告',
            divid: 'microad-test-2',
            divclass: 'makAd',
            adslot: '4279417',
            dom: 'body',
            place: 'append',
            stycss: 'margin:0',
            wait: ''
        }];

        const MainFunction = ((w, adsBlock) => {

            /// ========== [ Create init function ] ========== ///

            let initMicroAd = (AdDom, AdBody, place, times) => {
                times ? times : 0;
                let CheckAdDom_microad = function() {
                    if (AdDom) {
                        switch (place) {
                            case 'before':
                                AdDom.parentNode.insertBefore(AdBody, AdDom);
                                break;
                            case 'after':
                                AdDom.parentNode.insertBefore(AdBody, AdDom.nextSibling);
                                break;
                            case 'html':
                                AdDom.innerHTML = '';
                                AdDom.appendChild(AdBody);
                                break;
                            case 'append':
                                AdDom.appendChild(AdBody);
                                break;
                            case 'prepend':
                                AdDom.insertBefore(AdBody, AdDom.firstChild);
                                break;
                        }
                    } else {
                        if (times > 0) {
                            times--;
                            setTimeout(CheckAdDom_microad, 500);
                        }
                    }
                }
                CheckAdDom_microad();
            }

            /// ========== [ Create Adsense Body DOM ] ========== ///

            for (let B of adsBlock_microad) {
                /* ---------- create Outer divDom ---------- */
                let AdDom = document.querySelector(B.dom);
                let AdBody = document.createElement('div');
                AdBody.id = `MicroAd-${B.divid}`;
                AdBody.className = B.divclass;
                AdBody.style = B.divstycss

                /* ---------- create Inner divDom ---------- */
                let MicroAdDiv = document.createElement('div');
                MicroAdDiv.id = `compass-fit-${B.adslot}`;

                /* ---------- create MicroAd script ---------- */
                let MicroAdScript = document.createElement('script');
                MicroAdScript.text = `(function(){
                var _lgy_lw = document.createElement("script");
    	            _lgy_lw.type = "text/javascript";
    	            _lgy_lw.charset = "UTF-8";
    	            _lgy_lw.async = true;
    	            _lgy_lw.src= (("https:" == document.location.protocol) ? "https://" : "http://")+"nt.compass-fit.jp/lift_widget.js?adspot_id=${B.adslot}";
                var _lgy_lw_0 = document.getElementsByTagName("script")[0];
    	            _lgy_lw_0.parentNode.insertBefore(_lgy_lw, _lgy_lw_0);
            })();`;

                /* ---------- append Inner Dom & script ---------- */
                AdBody.appendChild(MicroAdDiv);
                AdBody.appendChild(MicroAdScript);

                /* ---------- Call initMicroAd Function ----------*/
                initMicroAd(AdDom, AdBody, B.place, B.wait);
            }
        })(window, adsBlock_microad);
    </script>
</body>

</html>